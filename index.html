<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圖片轉 GIF - 本機執行版</title>
    
    <script src="gifshot.min.js"></script>
    
    <style>
        body { font-family: sans-serif; background: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 400px; text-align: center; }
        .status { padding: 10px; margin-bottom: 10px; border-radius: 5px; font-size: 14px; }
        .ok { background: #d4edda; color: #155724; }
        .err { background: #f8d7da; color: #721c24; }
        input[type="file"] { margin: 20px 0; }
        button { background: #007bff; color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; width: 100%; font-weight: bold; }
        button:disabled { background: #ccc; }
        #result img { max-width: 100%; margin-top: 20px; border-radius: 8px; }
    </style>
</head>
<body>

<div class="card">
    <h2>單圖轉 GIF</h2>
    
    <div id="check" class="status">檢查中...</div>

    <input type="file" id="picInput" accept="image/*">
    <p id="tip" style="color: #666; font-size: 13px;">請選取一張圖片</p>
    
    <button id="runBtn" disabled>請先載入元件</button>

    <div id="result" style="display:none;">
        <hr>
        <div id="gifArea"></div>
        <br>
        <a id="save" download="my.gif"><button style="background:#28a745">下載 GIF</button></a>
    </div>
</div>

<script>
    // 自動檢查本地的 gifshot.min.js 有沒有放對位置
    window.onload = function() {
        if (typeof gifshot !== 'undefined') {
            document.getElementById('check').innerText = "✅ 引擎載入成功 (本機檔案)";
            document.getElementById('check').className = "status ok";
            document.getElementById('runBtn').disabled = false;
            document.getElementById('runBtn').innerText = "開始轉換";
        } else {
            document.getElementById('check').innerHTML = "❌ 找不到 gifshot.min.js<br><small>請確認檔案是否跟網頁放在同一個資料夾</small>";
            document.getElementById('check').className = "status err";
        }
    };

    document.getElementById('runBtn').onclick = function() {
        const file = document.getElementById('picInput').files[0];
        if (!file) { alert("未選取圖片"); return; }

        document.getElementById('tip').innerText = "⏳ 處理中...";
        this.disabled = true;

        const reader = new FileReader();
        reader.onload = function(e) {
            gifshot.createGIF({
                images: [e.target.result],
                gifWidth: 500,
                gifHeight: 500,
                numFrames: 1
            }, function(obj) {
                if (!obj.error) {
                    document.getElementById('gifArea').innerHTML = `<img src="${obj.image}">`;
                    document.getElementById('save').href = obj.image;
                    document.getElementById('result').style.display = "block";
                    document.getElementById('tip').innerText = "✅ 轉換成功";
                } else {
                    document.getElementById('tip').innerText = "❌ 錯誤：" + obj.error;
                }
                document.getElementById('runBtn').disabled = false;
            });
        };
        reader.readAsDataURL(file);
    };
</script>

</body>
</html>
